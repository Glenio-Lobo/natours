{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js"],"sourcesContent":["import { login, logout } from './login.js';\r\nimport { updateSettings } from './updateSettings.js';\r\nimport 'core-js/actual';\r\nimport \"regenerator-runtime/runtime.js\";\r\n\r\n// DOM Elements\r\nconst loginForm =  document.querySelector('.form--login')\r\nconst logoutButton = document.querySelector('.nav__el--logout');\r\nconst formUserData = document.querySelector('.form-user-data');\r\nconst formUserPass = document.querySelector('.form-user-settings');\r\n\r\n\r\n// Delegation\r\n\r\nif(loginForm){\r\n    loginForm.addEventListener('submit', e => {\r\n        e.preventDefault();\r\n\r\n        const email = document.getElementById('email').value;\r\n        const password = document.getElementById('password').value;\r\n\r\n        login(email, password);\r\n    })\r\n}\r\n\r\nif(logoutButton){\r\n    logoutButton.addEventListener('click', logout);\r\n}\r\n\r\nif(formUserData){\r\n    formUserData.addEventListener('submit', function(e){\r\n        e.preventDefault();\r\n        \r\n        const form = new FormData(formUserData);\r\n        \r\n        updateSettings(form, 'data');\r\n    })\r\n}\r\n\r\nif(formUserPass){\r\n    formUserPass.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n\r\n        document.querySelector('.btn--save-password ').textContent = 'Updating...';\r\n\r\n        const passwordCurrent = document.querySelector('#password-current').value;\r\n        const password = document.querySelector('#password').value;\r\n        const passwordConfirmed = document.querySelector('#password-confirm').value;\r\n\r\n        await updateSettings({ passwordCurrent, password, passwordConfirmed }, 'password');\r\n\r\n        document.querySelector('.btn--save-password ').textContent = 'Save password';\r\n        document.querySelector('#password-current').value = '';\r\n        document.querySelector('#password').value = '';\r\n        document.querySelector('#password-confirm').value = '';\r\n    })\r\n}","import axios from 'axios';\r\nimport { showAlerts } from './alerts.js';\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nexport const login = async function(email, password){\r\n    try{\r\n        const res = await axios({\r\n            method: 'POST',\r\n            url: '/api/v1/users/login',\r\n            data: {\r\n                email,\r\n                password\r\n            },  \r\n            withCredentials: true\r\n        });\r\n        \r\n        if(res.data.status === 'success'){\r\n            showAlerts('success', 'Logged In');\r\n            window.setTimeout(()=>{\r\n                location.assign('/');\r\n            }, 1500)\r\n        }\r\n        \r\n    }catch(err){\r\n        console.log(err.response.data);\r\n        showAlerts('error', 'Wrong username or password.');\r\n    }\r\n}\r\n\r\nexport const logout = async function(){\r\n    try{\r\n        const res = await axios({\r\n            method: 'GET',\r\n            url: '/api/v1/users/logout',\r\n        })\r\n\r\n        // reload page\r\n        // .reload(true) força o reload a partir do server e não do cache do browser\r\n        if(res.data.status === 'success') location.assign('/');\r\n        \r\n        // location.reload(true); \r\n        \r\n    }catch(err){\r\n        console.log(err);\r\n        showAlerts('error', 'No Internet. Logged Out.');\r\n    }\r\n}","\r\nexport const hideAlert = function() {\r\n    const el = document.querySelector('.alert');\r\n\r\n    if(el) el.parentElement.removeChild(el);\r\n}\r\n\r\n// type é ou \"success\" ou \"error\"\r\nexport const showAlerts = function(type, msg) {\r\n    hideAlert();\r\n\r\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n\r\n    window.setTimeout(hideAlert, 5000);\r\n}","import axios from 'axios';\r\nimport { showAlerts } from './alerts.js';\r\n\r\n// type é password or data\r\nexport const updateSettings = async function(data, type){\r\n    try{            \r\n        const result = await axios({\r\n            method: 'PATCH',\r\n            url: `${type === 'data' ? '/api/v1/users/updateMe' : '/api/v1/users/updateMyPassword'}`,\r\n            data\r\n        });\r\n    \r\n        if(result.data.status === 'success'){\r\n            showAlerts('success', `${type.toUpperCase()} updated successfully!.`);\r\n        }\r\n    }catch(err){\r\n        showAlerts('error', err.response.data.message);\r\n    }\r\n};"],"names":[],"version":3,"file":"app.js.map","sourceRoot":"/"}